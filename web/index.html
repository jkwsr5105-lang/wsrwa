<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>WABA Full SaaS</title>
<style>
body{font-family:Arial; max-width:800px; margin:40px auto; padding:0 16px;}
textarea,input{width:100%; padding:10px; margin:8px 0;}
button{padding:10px 16px; margin-top:8px; cursor:pointer;}
pre{background:#f5f5f5; padding:12px;}
</style>
</head>
<body>
<h1>WhatsApp Full SaaS Demo</h1>

<h3>Send Template Message</h3>
<textarea id="numbers" placeholder="One number per line"></textarea>
<textarea id="message" placeholder="Message with {{variables}}"></textarea>
<button onclick="send()">Send</button>

<h3>Upload CSV</h3>
<input type="file" id="csvFile" />
<button onclick="uploadCSV()">Upload</button>

<h3>Dashboard</h3>
<pre id="dashboard">No messages yet.</pre>

<script>
async function send(){
  const numbers = document.getElementById('numbers').value.split('\\n').map(s=>s.trim()).filter(Boolean);
  const message = document.getElementById('message').value;
  const resp = await fetch('/api/send',{ method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({numbers,message}) });
  const data = await resp.json();
  alert(JSON.stringify(data,null,2));
}
async function uploadCSV(){
  const file = document.getElementById('csvFile').files[0];
  const form = new FormData();
  form.append('file', file);
  const resp = await fetch('/api/upload-csv',{ method:'POST', body:form });
  const data = await resp.json();
  alert(JSON.stringify(data,null,2));
}
async function refreshDashboard(){
  const resp = await fetch('/api/dashboard');
  const data = await resp.json();
  document.getElementById('dashboard').textContent = JSON.stringify(data,null,2);
}
setInterval(refreshDashboard,3000);
</script>
</body>
</html>
